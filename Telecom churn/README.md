## Прогнозирование оттока клиентов
***Статус проекта:*** Завершён. 

***Навыки и инструменты:***  `python`, `pandas`, `numpy`, `matplotlib`, `seaborn`, `sklearn`,`LightGBM`, `CatBoost`, `StandardScaler`, `OneHotEncoder`, `Pipeline`, `ColumnTransformer`, `GridSearchCV`, `машинное обучение`, `прогнозирование оттока`

***Задача:***  
-  Построить модель для прогнозирования оттока клиентов оператора связи.

❗ Важно получить метрику качества `AUC-ROC` не меньше 0.88. 

***Данные:***
- Набор данных о клиентах, информация об их тарифах и договорах.
- Информация о договорах актуальна на 1 февраля 2020 года.

***Дополнительные условия:*** 
- основная метрика качества — `AUC-ROC`, вспомогательная — `accuracy`.
- ограничений по используемым моделям нет.

***Что было сделано:***  
- Изучили и предобработали данные.
- Добавили признак `LTDays` — длительность контракта в днях.
- Объединили таблицы.
- Пропущенные значения после объединения таблиц записали как `Unsupported`.
- Из обучающих признаков удалили `BeginDate`,`EndDate` и `TotalCharges`.
- Подготовили данные к обучению, отделив 20% на тестовую выборку.
- Написали `preprocessor` со `StandardScaler` для числовых признаков и `OneHotEncoder` для категориальных.
- Нашли оптимальные параметры с помощью `GridSearchCV`. Результаты и зафиченные модели(`best_estimator_`) сохранены в `best_results_fe`.
- Исследовали важность признаков для трёх лучших моделей.
- Протестировали лучшие модели на тестовой выборки, построили матрицы ошибок, ROC- и PR-кривые.
- Рассчитали дополнительные метрики: F1-меру, average precision, precision, recall.

***Результаты:***  
- Модели, которые использовались в проекте: 
    - LogisticRegression
    - KNeighborsClassifier
    - DecisionTreeClassifier
    - RandomForestClassifier
    - LGBMRegressor
    - CatBoostRegressor
    
- Лучший результат из рассмотренных моделей у CatBoostClassifier, ROC-AUC на тесте 0.931, это выше целевого 0.88.  
- Стоит отметить, что у модели RandomForestClassifier меньше всего ошибок второго рода и самое высокое значение метрики полноты(`recall` 0.767) 
- Для CatBoostClassifier и LGBMClassifier во вклад в метрику с большим отрывом лидирует длительность конктракта в днях, для RandomForestClassifier самый важный признак - тип контракта.

Подробные результаты с графиками можно посмотреть в пункте `Тестирование лучших моделей`, метрики и параметры лучших моделей сохранены в `test_results_fe`.  

***Что еще надо сделать:***
- Получить от коммерческого отдела информацию о себестоимости услуг.
- Если у нас будет информация по стоимости удержания клиента и убытках от ухода, то мы сможем понять цену ошибки предсказания и точнее подобрать модели.
- Можем даже кластеризовать клиентов и построить разные модели для каждой группы.