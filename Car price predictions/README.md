## Определение стоимости автомобилей
***Статус проекта:*** Завершён. 

***Навыки и инструменты:***  `python`, `pandas`, `numpy`, `matplotlib`, `seaborn`, `sklearn`,`LightGBM`, `Ridge`, `CatBoost`, `GridSearchCV`, `StandardScaler`, `OneHotEncoder`,`машинное обучение`

***Задача:***  
-  построить модель для определения стоимости автомобилей, модель будет использоваться в мобильном приложении.

❗ Заказчику важны:
- качество предсказания;
- скорость предсказания;
- время обучения.

***Данные:***
- исторические данные: технические характеристики, комплектации и цены автомобилей.

***Дополнительные условия:*** 
- использовать несколько моделей для сравнения, в т.ч. самые простые;
- использовать библиотеку LightGBM;
- подобрать только два-три гиперпараметра, ограничение обусловлено скоростью обучения моделей бустинга;
- метрика качества — RMSE.

***Что было сделано:***  
- Изучили и предобработали данные;
- Провалидировали и удалили некорректные значения;
- Удалили из базы машины дешевле 300 евро;
- Удалили машины старше 1960 года и младше года создания объявления;
- Удалили пропуски в `Model`;
- Заполнили пропуски в `FuelType`, `VehicleType` и `Gearbox` самыми популярными значениями по связке `Brand`+`Model`;
- Пропущенные значения `NotRepaired` перевели в неизвестные;
- Удалили все машины, мощнее 500 л.с., при этом оставили машины с нулевым значением, предположив, что они без двигателя;
- Из обучающих признаков удалили `NumberOfPictures`, `DateCrawled`, `DateCreated`, `LastSeen`, `PostalCode` и  `RegistrationMonth`
- Подготовили данные к обучению, разбив на две группы: с применением OHE и без;
- Промасштабировали StandardScaler'ом численные признаки.

***Результаты:***  
- Модели, которые использовались в проекте: 
    - линейная модель: Ridge
    - модели градиентного бустинга: LGBMRegressor, CatBoostRegressor
    - константная модель: DummyRegressor
    
Лучший результат из рассмотренных показали модели LGBMRegressor.    
    
*Результаты, отсортированные по значению rmse:*    

|        model_name |                                                    params |  fit_time | predict_time |        rmse |
|------------------:|----------------------------------------------------------:|----------:|-------------:|------------:|
|     LGBMRegressor | {'learning_rate': 0.4, 'max_depth': 10, 'metric': 'rmse'} |  0.654 |     0.141 | 1575 |
| CatBoostRegressor | {'iterations': 200, 'loss_function': 'RMSE'}              | 37.138 |     0.120 | 1606 |
| CatBoostRegressor | {'iterations': 50, 'loss_function': 'RMSE'}               | 10.706 |     0.064 | 1705 |
|             Ridge | {'alpha': 0.01, 'solver': 'cholesky'}                     |  2.423 |     0.124 | 2683 |
|             Ridge | {'alpha': 0.1, 'solver': 'cholesky'}                      |  3.851 |     0.154 | 2683 |
|             Ridge | {'alpha': 1.0, 'solver': 'auto'}                          |  5.224 |     0.174 | 2683 |
|    DummyRegressor | strategy': 'median'}                                      |  0.003 |     0.000 | 4860 |

***Что еще надо сделать:***
- Выяснить максимально допустимое время и провести расширенное исследование гиперпараметров моделей;
- Выяснить мощность оборудования заказчика для работы модели в болевых условиях, сейчас прошлось отказаться от создания полноценного Рipeline с ColumnTransformer и GridSearch на всех моделях из-за слишком долгого времени просчёта; 
- Пообщаться с product-owner мобильного приложения и предложить помощь в создании правил валидации вводимых данных. Это значительно облегчит не только предобработку даннных для построения модели, но и поможет аналитикам и бизнесу получить качественные отчеты;
- Разобраться с отсутствием фотографий, если их нет из-за ошибки при выгрузке, то получить корректную выгрузку и заново обучить модель. Если же это еще не реализованный функционал приложения, то надо опять же пообщаться с product-owner, чтобы быть готовым предложить новую модель, когда будут доступны данные о фото;
- Предложить использовать дату выпуска вместо даты регистрации, потому что регистрация - это по сути смена владельца, которая не отражает реальный возраст машины.
